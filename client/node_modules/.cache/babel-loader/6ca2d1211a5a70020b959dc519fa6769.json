{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Valentin\\\\Desktop\\\\React\\\\eCoal\\\\e.COAL\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Valentin\\\\Desktop\\\\React\\\\eCoal\\\\e.COAL\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Valentin\\\\Desktop\\\\React\\\\eCoal\\\\e.COAL\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Valentin\\\\Desktop\\\\React\\\\eCoal\\\\e.COAL\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\Valentin\\\\Desktop\\\\React\\\\eCoal\\\\e.COAL\\\\client\\\\src\\\\Login.js\";\nimport React from 'react';\nimport axios from \"axios\";\nimport { Route } from 'react-router-dom';\nimport { HTTP_SERVER_PORT } from \"./constants\";\nvar LOGIN = 1;\nvar SIGNUP = 2;\n\nvar Login =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Login, _React$Component);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Login).call(this, props));\n\n    _this.login = function (user) {\n      if (user) {\n        axios.post(HTTP_SERVER_PORT + 'login', user).then(function (res) {\n          if (res.data.isConnected) {\n            _this.setSessionUser(user);\n\n            _this.setState({\n              user: user,\n              authenticated: true\n            });\n\n            _this.props.checkConnexion(true);\n          }\n        });\n      }\n    };\n\n    _this.signUp = function (user) {\n      axios.post(HTTP_SERVER_PORT + 'signUp', user).then(function (res) {\n        if (res.data.isConnected) _this.login(user);\n      });\n    };\n\n    _this.logout = function () {\n      sessionStorage.clear();\n\n      _this.setState({\n        user: null,\n        authenticated: null\n      });\n\n      _this.props.checkConnexion(false);\n    };\n\n    _this.getSessionUser = function () {\n      if (!sessionStorage.getItem('username')) {\n        return null;\n      }\n\n      return {\n        username: sessionStorage.getItem('username'),\n        password: sessionStorage.getItem('password')\n      };\n    };\n\n    _this.setSessionUser = function (user) {\n      sessionStorage.setItem('username', user.username);\n      sessionStorage.setItem('password', user.password);\n    };\n\n    _this.handleForm = function (e) {\n      e.preventDefault();\n      var user = {\n        username: e.target.username.value,\n        password: e.target.password.value\n      };\n\n      if (user && user.username && user.password) {\n        if (_this.action === LOGIN) _this.login(user);else if (_this.action === SIGNUP) _this.signUp(user);\n      }\n\n      _this.toggleForm();\n    };\n\n    _this.toggleForm = function () {\n      _this.setState({\n        renderForm: !_this.state.renderForm\n      });\n    };\n\n    _this.mark = function (x) {\n      _this.action = +x;\n    };\n\n    _this.renderForm = function () {\n      if (!_this.state.renderForm) return null;\n      return React.createElement(\"div\", {\n        id: \"container\",\n        onSubmit: function onSubmit(e) {\n          return _this.handleForm(e);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, \"Login\"), React.createElement(\"form\", {\n        onSubmit: function onSubmit() {\n          return _this.checkLogin();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Username\", React.createElement(\"input\", {\n        type: \"text\",\n        name: \"username\",\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      })), React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, \"Password\", React.createElement(\"input\", {\n        type: \"password\",\n        name: \"password\",\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        className: \"btn margin-auto\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, \"Submit\"), React.createElement(\"button\", {\n        type: \"submit\",\n        name: \"login\",\n        value: \"Log In\",\n        onClick: function onClick() {\n          return _this.mark(LOGIN);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, \"Login\"), React.createElement(\"button\", {\n        type: \"submit\",\n        name: \"signup\",\n        value: \"Sign up\",\n        onClick: function onClick() {\n          return _this.mark(SIGNUP);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, \"Sign up\")));\n    };\n\n    _this.render = function () {\n      if (_this.state.user && _this.state.authenticated) {\n        return React.createElement(React.Fragment, null, React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131\n          },\n          __self: this\n        }, _this.state.user.username), React.createElement(\"button\", {\n          type: \"button\",\n          name: \"logout\",\n          className: \"btn btn-secondary\",\n          onClick: _this.logout,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        }, \"logout\"));\n      } else {\n        return React.createElement(React.Fragment, null, React.createElement(\"button\", {\n          type: \"button\",\n          name: \"login\",\n          className: \"btn btn-secondary my-2 my-sm-0\",\n          onClick: _this.toggleForm,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }, \"login\"), _this.renderForm());\n      }\n    };\n\n    _this.state = {\n      user: null,\n      authenticated: false,\n      renderForm: false\n    };\n\n    if (_this.getSessionUser()) {\n      _this.login(_this.getSessionUser());\n    }\n\n    return _this;\n  }\n\n  return Login;\n}(React.Component);\n\nLogin.getUser = function () {\n  if (!sessionStorage.getItem('username')) {\n    return null;\n  }\n\n  return {\n    username: sessionStorage.getItem('username'),\n    password: sessionStorage.getItem('password')\n  };\n};\n\nexport var ProtectedRoute = function ProtectedRoute(props) {\n  if (Login.getUser()) return React.createElement(Route, {\n    exact: props.exact,\n    path: props.path,\n    component: props.component,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  });\n  return null;\n};\nexport default Login;","map":{"version":3,"sources":["C:\\Users\\Valentin\\Desktop\\React\\eCoal\\e.COAL\\client\\src\\Login.js"],"names":["React","axios","Route","HTTP_SERVER_PORT","LOGIN","SIGNUP","Login","props","login","user","post","then","res","data","isConnected","setSessionUser","setState","authenticated","checkConnexion","signUp","logout","sessionStorage","clear","getSessionUser","getItem","username","password","setItem","handleForm","e","preventDefault","target","value","action","toggleForm","renderForm","state","mark","x","checkLogin","render","Component","getUser","ProtectedRoute","exact","path","component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from \"axios\";\nimport {Route} from 'react-router-dom';\n\nimport {HTTP_SERVER_PORT} from \"./constants\";\n\nconst LOGIN = 1;\nconst SIGNUP = 2;\n\nclass Login extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            user: null,\n            authenticated: false,\n            renderForm: false\n        };\n        if (this.getSessionUser()) {\n            this.login(this.getSessionUser())\n        }\n    }\n\n    login = (user) => {\n        if (user) {\n            axios.post(HTTP_SERVER_PORT + 'login', user)\n                .then(res => {\n                    if (res.data.isConnected) {\n                        this.setSessionUser(user);\n                        this.setState({\n                            user: user,\n                            authenticated: true\n                        });\n                        this.props.checkConnexion(true);\n                    }\n                })\n        }\n    };\n\n    signUp = (user) => {\n        axios.post(HTTP_SERVER_PORT + 'signUp', user)\n            .then(res => {\n                if (res.data.isConnected) this.login(user)\n            });\n    };\n\n    logout = () => {\n        sessionStorage.clear();\n        this.setState({\n            user: null,\n            authenticated: null\n        });\n        this.props.checkConnexion(false);\n    };\n\n    getSessionUser = () => {\n        if (!sessionStorage.getItem('username')) {\n            return null;\n        }\n        return ({\n            username: sessionStorage.getItem('username'),\n            password: sessionStorage.getItem('password')\n        })\n    };\n\n    setSessionUser = (user) => {\n        sessionStorage.setItem('username', user.username);\n        sessionStorage.setItem('password', user.password);\n    };\n\n    // --- static methods ---\n    static getUser = () => {\n        if (!sessionStorage.getItem('username')) {\n            return null;\n        }\n        return ({\n            username: sessionStorage.getItem('username'),\n            password: sessionStorage.getItem('password')\n        })\n    };\n\n    // --- form methods\n    handleForm = (e) => {\n        e.preventDefault();\n        const user = {\n            username: e.target.username.value,\n            password: e.target.password.value\n        };\n        if (user && user.username && user.password) {\n            if (this.action === LOGIN) this.login(user);\n            else if (this.action === SIGNUP) this.signUp(user);\n        }\n        this.toggleForm();\n    };\n\n    toggleForm = () => {\n        this.setState({renderForm: !this.state.renderForm});\n    };\n\n    mark = (x) => {\n        this.action = +x;\n    };\n\n    renderForm = () => {\n        if (!this.state.renderForm) return null;\n        return (\n          <div id=\"container\" onSubmit={e => this.handleForm(e)}>\n            <h1>Login</h1>\n            <form onSubmit={() => this.checkLogin()}>\n              <label>\n                Username\n                <input type=\"text\" name=\"username\" required ></input>\n              </label>\n\n              <label>\n                Password\n                <input type=\"password\" name=\"password\" required></input>\n              </label>\n\n              <button className=\"btn margin-auto\">Submit</button>\n              <button type=\"submit\" name=\"login\" value=\"Log In\" onClick={() => this.mark(LOGIN)}>Login</button>\n              <button type=\"submit\" name=\"signup\" value=\"Sign up\" onClick={() => this.mark(SIGNUP)}>Sign up</button>\n            </form>\n          </div>\n        );\n    };\n\n    render = () => {\n        if (this.state.user && this.state.authenticated) {\n            return (\n                <>\n                    <p>{this.state.user.username}</p>\n                    <button type=\"button\" name=\"logout\" className=\"btn btn-secondary\" onClick={this.logout}>logout\n                    </button>\n                </>\n            )\n        } else {\n            return (\n                <>\n                    <button type=\"button\" name=\"login\" className=\"btn btn-secondary my-2 my-sm-0\" onClick={this.toggleForm}>login\n                    </button>\n                    {this.renderForm()}\n                </>\n            )\n        }\n\n    }\n}\n\nexport const ProtectedRoute = (props) => {\n    if (Login.getUser())\n        return (<Route exact={props.exact} path={props.path} component={props.component}/>);\n    return null;\n};\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}